<!doctype HTML>
<html>

  <head>
    <title>Occam's Machete - Fooling with Fluids</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=768, initial-scale=1" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital@0;1&family=Poppins:wght@300&display=swap" rel="stylesheet">    
    <style>
      html
      {
        font-size: 14px;
        font-family: 'Poppins', sans-serif;
        background-color: #222;
        color: #bbb;
        padding-left: min(8%, 80px);
        padding-right: min(8%, 80px);
        margin: 0;
      }
      body
      {
        margin: 0;
      }
      section
      {
        overflow: hidden;
        margin-top: 50px;
        text-align: center;
      }
      header
      {
        xheight: 400px;
      }
      video
      {
        width: 100%;
        max-width: 800px;
      }
      h1
      {
        font-family: 'Playfair Display', serif;
        font-style: italic;
        font-size: 5rem;
        border-left: 40px solid #f00;
        padding: 0 0 0 35px;
        margin: 3rem 0;
        vertical-align: bottom;
        letter-spacing: 4px;
        text-align: start;
        text-shadow: 5px 5px 4px black;
      }
      h2
      {
        font-family: 'Playfair Display', serif;
        font-style: italic;
        font-size: 2.5rem;
        border-left: 15px solid #f00;
        padding: 0 0 0 15px;
        vertical-align: bottom;
        letter-spacing: 4px;
        text-align: start;
      }
      h3
      {
        font-size: 1rem;
        text-align: start;
        margin: 1em;
      }
      a
      {
        color: #bbb;
        animation: 2s alternate infinite pulse;
        text-decoration: none;
      }
      p
      {
        font-size: 1.5rem;
        padding: 0;
        margin: 0 0 50px 0;
        text-align: start;
      }
      ul
      {
        font-size: 1.5rem;
        text-align: start;
      }
      span
      {
        border-left: 15px solid #f00;
        padding: 0 0 0 15px;
      }

      @keyframes pulse
      {
        from
        {
          color: #bbb;
        }

        to
        {
          color: #fff;
        }
      }

      #s1
      {
        position: relative;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        margin: 0;
        justify-content: space-between;
      }
      #s1 video
      {
        position: absolute;
        height: 100%;
        object-fit: cover;
        margin: 0 0 100px 0;
        max-width: inherit;
        z-index: -1;
        top: 0;
        left: 0;
      }
      #s1 div
      {
        width: 70%;
        background-color: #000c;
        padding: min(8%, 40px);
        margin: 0;
        align-self: end;
      }
      #s1 p
      {
        padding: 0;
        margin: 0;
        font-size: 2rem;
      }

      #s2 video
      {
        margin-bottom: max(-400px, -50%);
      }

      #s3 video
      {
        margin-bottom: max(-300px, -40%);
      }

      /*@media (min-resolution: 300dpi)*/
      @media (max-width: 768px)
      {
        html
        {
          font-size: 12px;
        }
        h1
        {
          padding: 0 0 0 15px;
          border-left: 15px solid #f00;
          font-size: 5rem;
        }
        span
        {
          border-left: 10px solid #f00;
          padding: 0 0 0 5px;
        }

        #s1 p
        {
          font-size: 2rem;
        }
      }
    </style>
  </head>

  <body>
    <section id="s1">
      <header>
        <h3>Esteban Ramirez - 21/08/2023</h3>
        <h1>Fooling with Fluids</h1>
      </header>
      <video src="video/webgl-fluid-simulation.mp4" autoplay loop muted playsinline></video>
      <div>
        <p>
          So I've fallen into yet another internet rabbit hole. This time it's Fluid Dynamics. 
          Years ago I came across an 
          <a href="https://nerget.com/fluidSim">interesting fluid effect</a> 
          written in Javascript by Oliver Hunt which, in turn, is based on a great paper titled 
          <a href="http://graphics.cs.cmu.edu/nsp/course/15-464/Fall09/papers/StamFluidforGames.pdf">"Real-Time Fluid Dynamics for Games"</a> 
          by Jos Stam. Since then, several mobile apps and web sites have appeared that showcase the 
          related algorithms, and they are mesmerising. I've listed a few at the end of this article.
        </p>
      </div>
    </section>
    <section id="s2">
      <div>
        <p>
          <span>N</span>aturally, after fooling around with these websites, my first thought was "Surely someone's 
          written a game with this stuff!". Unfortunately, most of what I came across were screensavers 
          and "stress-release" apps, with the only exception being a 
          <a href="https://js13kgames.com/games/interplanetary-postal-service/index.html">"lunar lander" game</a>. 
          Was this because there was an inherent limitation? Can it only be applied to visual 
          effects? Only one way to find out. Try something myself.
        </p>
      </div>
      <video src="video/interplanetary-postal-service.mp4" autoplay loop muted playsinline></video>
    </section>
    <section id="s3">
      <div>
        <p>
          <span>S</span>o, where to start? "Oliver's simple fluid dynamics simulator" seemed like a good place. 
          It's JavaScript only, has no other dependencies, and runs reasonably on my ancient laptop. 
          Better still, it doesn't use any Frontend framework (apparently it's possible to build 
          stuff without React ðŸ˜‰). The code resides in three files with the heavy mathematical 
          lifting going on in "pressure.js" and the UI split over "index.html" and 
          "pressure-display.js". There's no public repository for the code as I suspect it was 
          written before such services were available. If you'd like to see the code you'll have to 
          save it off the 
          <a href="https://nerget.com/fluidSim">site</a>.
        </p>
      </div>
      <video src="video/olivers-fluid-dynamics-simulator.mp4" autoplay loop muted playsinline></video>
    </section>
    <section id="s4">
      <div>
        <p>
          <span>W</span>ithout knowing what kind of game to write, I proceeded to combine the JavaScript in 
          "index.html" and "pressure-display.js" into a single Web Component. In case it's not 
          obvious by now, I too will be sticking with JavaScript and the 
          <a href="http://vanilla-js.com/">Vanilla JS</a> framework. Why 
          not TypeScript and React? Because I intend to come out of this rabbit hole with my 
          sanity intact. Besides, Vanilla JS is a consistent winner on 
          <a href="https://krausest.github.io/js-framework-benchmark/2022/table_chrome_104_windows.html">The Benchmark</a>. 
          The resulting game code is available on 
          <a href="https://github.com/netssrmrz/blog/tree/main/fluidSim">Github</a>.
        </p>
        <p>
          <span>T</span>he game is, of course, ludicrously "simple". All you have to do is herd the cats into 
          the central building. You do this by swiping currents with the mouse or via touch, until 
          time runs out. Oliver's code exposes a couple of functions to extract the "velocity" at a 
          given point on the surface of the fluid so I coupled this to a few floating cats 
          (as one does) and voilÃ , 
          <a href="https://netssrmrz.github.io/blog/fluidSim/">Nauti-Cats</a>. 
          Oh, also, the code was converted to be less monochromatic and more Technicolor and, to be 
          truthful, it's not really playable on small phone screens.
        </p>
      </div>
      <video src="video/nauti-cats.mp4" autoplay loop muted playsinline></video>
    </section>
    <section id="s5">
      <div>
        <p>
          <span>I</span>n conclusion, it would seem there's no reason why someone couldn't get filthy rich 
          writing the next Floaty Bird, though, a more complex game world would help. To this end 
          we have 
          <a href="https://physics.weber.edu/schroeder/fluids/">Dan Schroeder's fluid dynamics simulation</a> 
          which allows one to build barriers 
          against which the fluid may flow. Additionally, there's the game 
          <a href="https://js13kgames.com/games/interplanetary-postal-service/index.html">Interplanetary Postal Service</a>
          which shows how this might work and I'd love to incorporate these effects into 
          more mundane websites, though they couldn't be triggered by mouse hovering as this would 
          exclude all touch-based devices. Perhaps "waves" could emanate from buttons and menu 
          selections and bounce off other content? The rabbit hole deepens and I haven't even 
          finished reading Stam's original research paper.
        </p>
        <p>
          <span>T</span>ruly there are some incredibly talented people in this world and it's wonderful that 
          idiots like me can, so easily, access and build on their work. It's both inspiring and 
          humbling. If I had half the ability of some of these folk, I'd have completed my humble 
          goal of world domination and decadent leisure by now.
        </p>
      </div>
      <video src="video/digital-marbling.mp4" autoplay loop muted playsinline></video>
    </section>
    <section id="s6">
      <p>
        <span>A</span>lmost forgot to mention, Nauti-Cats was only tested on Windows 10 Chrome v115, a Samsung 
        Galaxy Tab S6, and a Pixel 2 XL. If your device explodes due to processing overload, don't 
        blame me. Consider it an opportunity to upgrade.
      </p>
      <h2>Cool Fluid Dynamics Stuff</h2>
      <ul>
        <li><a href="https://paveldogreat.github.io/WebGL-Fluid-Simulation">WebGL Fluid Simulation</a> - Browser fluid simulation</li>
        <li><a href="https://experiments.withgoogle.com/search?q=fluid">Experiments with Google</a> - Browser fluid simulation</li>
        <li><a href="https://physics.weber.edu/schroeder/fluids">Fluid Dynamics Simulation</a> - Browser fluid simulation</li>
        <li><a href="https://play.google.com/store/apps/details?id=com.magicfluids.demo">Magic Fluids</a> - Android fluid simulation</li>
        <li><a href="https://play.google.com/store/apps/details?id=com.azmobile.fluidwallpaper">Fluid Live Wallpaper</a> - Android wallpaper</li>
        <li><a href="https://play.google.com/store/apps/details?id=ru.brothersappsandgames.superfluidasmr">Super Fluid ASMR</a> - Android fluid simulation</li>
        <li><a href="https://play.google.com/store/apps/details?id=com.enlightment.fluidwallpaper">Fluid Simulation</a> - Android fluid simulation</li>
        <li><a href="https://amandaghassaei.com/">Amanda Ghassaei</a> - Consultant and researcher</li>
        <li><a href="https://js13kgames.com/games/interplanetary-postal-service/index.html">Interplanetary Postal Service</a> - Browser game</li>
        <li><a href="https://www.amazon.com/Art-Fluid-Animation-Jos-Stam/dp/1498700209?&linkCode=sl1&tag=amandaghassae-20&linkId=514b8e783ca40b04488bf02d09fff19c&language=en_US&ref_=as_li_ss_tl">The Art of Fluid Animation</a> - Book by Jos Stam</li>
        <li><a href="https://jamie-wong.com/2016/08/05/webgl-fluid-simulation">Fluid Simulation (with WebGL demo)</a> - Tutorial by Jamie Wong</li>
      </ul>
    </section>
  </body>

</html>